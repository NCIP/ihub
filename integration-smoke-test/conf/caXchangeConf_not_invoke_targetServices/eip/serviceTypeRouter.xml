<?xml version="1.0" encoding="UTF-8"?>
	<!--

		Licensed to the Apache Software Foundation (ASF) under one or more
		contributor license agreements. See the NOTICE file distributed with
		this work for additional information regarding copyright ownership.
		The ASF licenses this file to You under the Apache License, Version
		2.0 (the "License"); you may not use this file except in compliance
		with the License. You may obtain a copy of the License at

		http://www.apache.org/licenses/LICENSE-2.0 Unless required by
		applicable law or agreed to in writing, software distributed under the
		License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
		CONDITIONS OF ANY KIND, either express or implied. See the License for
		the specific language governing permissions and limitations under the
		License.
	-->
<beans xmlns:eip="http://servicemix.apache.org/eip/1.0"
	xmlns:caxchange="http://nci.nih.gov/caXchange">

	<!-- content based router to route messages based on service types -->
	<eip:content-based-router service="caxchange:serviceTypeRouter"
		endpoint="caxchange:serviceTypeEndpoint">
		<eip:rules>
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='SCHEDULE_MODIFICATION']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:scheduleModificationRoute" />
				</eip:target>
			</eip:routing-rule>
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='LAB_BASED_AE']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:labBasedAeRoute" />
				</eip:target>
			</eip:routing-rule>
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='LOAD_LAB_TO_CDMS']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:loadLabToCDMSRoute" />
				</eip:target>
			</eip:routing-rule>
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='CT_LAB_DATA']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:ctLabDataRoute" />
				</eip:target>
			</eip:routing-rule>
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_CREATION']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:studyCreationRoute" />
				</eip:target>
			</eip:routing-rule>
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='PERSON']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:personServiceRoute" />
                               </eip:target>
                        </eip:routing-rule> 
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='ORGANIZATION']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:organizationServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>    
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='CLINICAL_RESEARCH_STAFF']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:clinicalResearchStaffServiceRoute" />
                               </eip:target>
                        </eip:routing-rule> 
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='HEALTH_CARE_FACILITY']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:healthCareFacilityServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>     
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='HEALTH_CARE_PROVIDER']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:healthCareProviderServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>    
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='IDENTIFIED_ORGANIZATION']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:identifiedOrganizationServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>        
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='IDENTIFIED_PERSON']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:identifiedPersonServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>            
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='ORGANIZATIONAL_CONTACT']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:organizationContactServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>         
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='RESEARCH_ORGANIZATION']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:researchOrganizationServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>            
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='OVERSIGHT_COMMITTEE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:oversightCommitteeServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>     
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_PROTOCOL']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyProtocolServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>  
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='ARM']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:armServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>  
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_SITE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studySiteServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                   
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='PLANNED_ACTIVITY']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:plannedActivityServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                             
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_CONTACT']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyContactServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                               
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_DISEASE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyDiseaseServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>     
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_OVERALL_STATUS']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyOverallStatusServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                             
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_SITE_CONTACT']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studySiteContactServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>          
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_RELATIONSHIP']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyRelationshipServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>         
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_RESOURCING']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyResourcingServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>        
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_IND_IDE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyIndIdeServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>   
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_ONHOLD']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyOnholdServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>             
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_OUTCOME_MEASURE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyOutcomeMeasureServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>    
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_RECRUITMENT_STATUS']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyRecruitmentStatusServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>  
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_REGULATORY_AUTHORITY']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studyRegulatoryAuthorityServiceRoute" />
                               </eip:target>
                        </eip:routing-rule> 
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='STUDY_SITE_ACCRUAL_STATUS']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:studySiteAccrualStatusServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>     
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='DOCUMENT']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:documentServiceRoute" />
                               </eip:target>
                        </eip:routing-rule> 
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='DOCUMENT_WORKFLOW_STATUS']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:documentWorkflowStatusServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                         
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='ORGANIZATION_BUSINESS_SERVICE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:organizationBusinessServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>   
                        <eip:routing-rule>
                               <eip:predicate>
                                   <eip:xpath-predicate xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='PERSON_BUSINESS_SERVICE']) = 1" namespaceContext="#nsContext"/>
                               </eip:predicate>
                               <eip:target>
                                  <eip:exchange-target service="caxchange:personBusinessServiceRoute" />
                               </eip:target>
                        </eip:routing-rule>                         
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='REGISTER_SUBJECT']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:registerSubjectRoute" />
				</eip:target>
			</eip:routing-rule>	
			<eip:routing-rule>
				<eip:predicate>
					<eip:xpath-predicate
						xpath="count(/caxchange:caXchangeRequestMessage/caxchange:metadata[caxchange:serviceType='CATISSUE']) = 1"
						namespaceContext="#nsContext" />
				</eip:predicate>
				<eip:target>
					<eip:exchange-target service="caxchange:caTissueCreateParticipantRoute" />
				</eip:target>
			</eip:routing-rule>			
			<eip:routing-rule>
				<eip:target>
					<eip:exchange-target service="caxchange:unhandledTypeRoute" />
				</eip:target>
			</eip:routing-rule>
		</eip:rules>
	</eip:content-based-router>
	

	<eip:namespace-context id="nsContext">
		<eip:namespaces>
			<eip:namespace prefix="caxchange">
				http://caXchange.nci.nih.gov/messaging</eip:namespace>
		</eip:namespaces>
	</eip:namespace-context>

</beans>
