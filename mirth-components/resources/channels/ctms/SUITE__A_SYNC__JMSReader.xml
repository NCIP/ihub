<com.webreach.mirth.model.Channel>
  <id>e9bbc6b7-cbac-413d-9b64-5dbe390a2739</id>
  <name>SUITE__A_SYNC__JMSReader</name>
  <description></description>
  <enabled>true</enabled>
  <version>1.8.2</version>
  <lastModified>
    <time>1301673517765</time>
    <timezone>America/New_York</timezone>
  </lastModified>
  <revision>215</revision>
  <sourceConnector>
    <name>sourceConnector</name>
    <properties>
      <property name="clientId"></property>
      <property name="useJndi">0</property>
      <property name="durable">0</property>
      <property name="selector"></property>
      <property name="connectionFactoryClass">org.apache.activemq.ActiveMQConnectionFactory</property>
      <property name="username"></property>
      <property name="specification">1.1</property>
      <property name="connectionFactoryProperties">&lt;properties&gt;
  &lt;property name=&quot;brokerURL&quot;&gt;tcp://@amq.ihub.host@:@amq.ihub.port@&lt;/property&gt;
&lt;/properties&gt;</property>
      <property name="acknowledgementMode">1</property>
      <property name="DataType">JMS Reader</property>
      <property name="password"></property>
      <property name="host">caxchangeInboundQueue</property>
    </properties>
    <transformer>
      <steps>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>0</sequenceNumber>
          <name>Initialize variables</name>
          <script>default xml namespace = &quot;http://caXchange.nci.nih.gov/messaging&quot;

channelMap.put(&apos;IS_IHUB_PROCESSING_ERROR&apos;, false);</script>
          <type>JavaScript</type>
          <data class="map">
            <entry>
              <string>Script</string>
              <string>default xml namespace = &quot;http://caXchange.nci.nih.gov/messaging&quot;

channelMap.put(&apos;IS_IHUB_PROCESSING_ERROR&apos;, false);</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>1</sequenceNumber>
          <name>ns1metadata_ns1caxchangeidentifier</name>
          <script>var mapping;try { mapping = msg[&apos;metadata&apos;][&apos;caXchangeIdentifier&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1metadata_ns1caxchangeidentifier&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;metadata&apos;][&apos;caXchangeIdentifier&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1metadata_ns1caxchangeidentifier</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>2</sequenceNumber>
          <name>ns1metadata</name>
          <script>var mapping;try { mapping = msg[&apos;metadata&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1metadata&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;metadata&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1metadata</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>3</sequenceNumber>
          <name>ns1request_ns1businessmessagepayload_ns1xmlschemadefinition</name>
          <script>var mapping;try { mapping = msg[&apos;request&apos;][&apos;businessMessagePayload&apos;][&apos;xmlSchemaDefinition&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1request_ns1businessmessagepayload_ns1xmlschemadefinition&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;request&apos;][&apos;businessMessagePayload&apos;][&apos;xmlSchemaDefinition&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1request_ns1businessmessagepayload_ns1xmlschemadefinition</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>4</sequenceNumber>
          <name>ns1request_ns1businessmessagepayload</name>
          <script>var mapping;try { mapping = msg[&apos;request&apos;][&apos;businessMessagePayload&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1request_ns1businessmessagepayload&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;request&apos;][&apos;businessMessagePayload&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1request_ns1businessmessagepayload</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>5</sequenceNumber>
          <name>ns1metadata_ns1servicetype</name>
          <script>var mapping;try { mapping = msg[&apos;metadata&apos;][&apos;serviceType&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1metadata_ns1servicetype&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;metadata&apos;][&apos;serviceType&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1metadata_ns1servicetype</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>6</sequenceNumber>
          <name>ns1metadata_ns1externalidentifier</name>
          <script>var mapping;try { mapping = msg[&apos;metadata&apos;][&apos;externalIdentifier&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1metadata_ns1externalidentifier&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;metadata&apos;][&apos;externalIdentifier&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1metadata_ns1externalidentifier</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
        <com.webreach.mirth.model.Step>
          <sequenceNumber>7</sequenceNumber>
          <name>ns1metadata_ns1credentials_ns1delegatedcredentialreference</name>
          <script>var mapping;try { mapping = msg[&apos;metadata&apos;][&apos;credentials&apos;][&apos;delegatedCredentialReference&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;ns1metadata_ns1credentials_ns1delegatedcredentialreference&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
          <type>Mapper</type>
          <data class="map">
            <entry>
              <string>Mapping</string>
              <string>msg[&apos;metadata&apos;][&apos;credentials&apos;][&apos;delegatedCredentialReference&apos;].toString()</string>
            </entry>
            <entry>
              <string>Variable</string>
              <string>ns1metadata_ns1credentials_ns1delegatedcredentialreference</string>
            </entry>
            <entry>
              <string>RegularExpressions</string>
              <list/>
            </entry>
            <entry>
              <string>DefaultValue</string>
              <string></string>
            </entry>
            <entry>
              <string>isGlobal</string>
              <string>channel</string>
            </entry>
          </data>
        </com.webreach.mirth.model.Step>
      </steps>
      <inboundTemplate>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#x0D;
&lt;ns1:caXchangeRequestMessage xmlns:ns1=&quot;http://caXchange.nci.nih.gov/messaging&quot;&gt;&#x0D;
 &lt;ns1:metadata&gt;&#x0D;
  &lt;ns1:transactionControl xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:nil=&quot;true&quot;/&gt;&#x0D;
  &lt;ns1:serviceType&gt;REGISTER_SUBJECT&lt;/ns1:serviceType&gt;&#x0D;
  &lt;ns1:externalIdentifier&gt;myExternalIdentifier&lt;/ns1:externalIdentifier&gt;&#x0D;
  &lt;ns1:caXchangeIdentifier&gt;d9491370-ac8f-11df-bdb2-e8f0d13a300b&lt;/ns1:caXchangeIdentifier&gt;&#x0D;
  &lt;ns1:credentials&gt;&#x0D;
   &lt;ns1:userName&gt;cctsdev1&lt;/ns1:userName&gt;&#x0D;
   &lt;ns1:gridIdentifier&gt;/O=caBIG/OU=caGrid/OU=Stage LOA1/OU=Dorian/CN=cctsdev1&lt;/ns1:gridIdentifier&gt;&#x0D;
   &lt;ns1:password&gt;An010101!!&lt;/ns1:password&gt;&#x0D;
   &lt;ns1:delegatedCredentialReference&gt;&amp;lt;ns1:DelegatedCredentialReference xmlns:ns1=&quot;http://cds.gaards.cagrid.org/CredentialDelegationService/DelegatedCredential/types&quot;&amp;gt;&#x0D;
 &amp;lt;ns2:EndpointReference xsi:type=&quot;ns2:EndpointReferenceType&quot; xmlns:ns2=&quot;http://schemas.xmlsoap.org/ws/2004/03/addressing&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&amp;gt;&#x0D;
  &amp;lt;ns2:Address xsi:type=&quot;ns2:AttributedURI&quot;&amp;gt;https://cagrid-cds-stage.nci.nih.gov:8443/wsrf/services/cagrid/DelegatedCredential&amp;lt;/ns2:Address&amp;gt;&#x0D;
  &amp;lt;ns2:ReferenceProperties xsi:type=&quot;ns2:ReferencePropertiesType&quot;&amp;gt;&#x0D;
   &amp;lt;ns2:DelegatedCredentialKey xmlns:ns2=&quot;http://cds.gaards.cagrid.org/CredentialDelegationService/DelegatedCredential&quot;&amp;gt;&#x0D;
    &amp;lt;ns3:delegationId xmlns:ns3=&quot;http://gaards.cagrid.org/cds&quot;&amp;gt;7898&amp;lt;/ns3:delegationId&amp;gt;&#x0D;
   &amp;lt;/ns2:DelegatedCredentialKey&amp;gt;&#x0D;
  &amp;lt;/ns2:ReferenceProperties&amp;gt;&#x0D;
  &amp;lt;ns2:ReferenceParameters xsi:type=&quot;ns2:ReferenceParametersType&quot;/&amp;gt;&#x0D;
 &amp;lt;/ns2:EndpointReference&amp;gt;&#x0D;
&amp;lt;/ns1:DelegatedCredentialReference&amp;gt;&#x0D;
&lt;/ns1:delegatedCredentialReference&gt;&#x0D;
  &lt;/ns1:credentials&gt;&#x0D;
 &lt;/ns1:metadata&gt;&#x0D;
 &lt;ns1:request&gt;&#x0D;
  &lt;ns1:businessMessagePayload&gt;&#x0D;
   &lt;ns1:xmlSchemaDefinition&gt;gme://ccts.cabig/1.0/gov.nih.nci.cabig.ccts.domain&lt;/ns1:xmlSchemaDefinition&gt;&#x0D;
   &lt;registration xmlns=&quot;gme://ccts.cabig/1.0/gov.nih.nci.cabig.ccts.domain&quot; xmlns:c3pr=&quot;gme://ccts.cabig/1.0/gov.nih.nci.cabig.ccts.domain&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; gridId=&quot;d9a8e595-d0b1-4404-8eab-1bc2238cec35&quot;&gt;&#x0D;
				   &lt;studySite&gt;&#x0D;
					   &lt;healthcareSite&gt;&#x0D;
						   &lt;name&gt;National Cancer Institute&lt;/name&gt;&#x0D;
&#x0D;
						   &lt;address&gt;&#x0D;
							   &lt;streetAddress&gt;6116 Executive Boulevard&lt;/streetAddress&gt;&#x0D;
&#x0D;
							   &lt;city&gt;Bethesda&lt;/city&gt;&#x0D;
&#x0D;
							   &lt;stateCode&gt;MD&lt;/stateCode&gt;&#x0D;
&#x0D;
							   &lt;postalCode&gt;20892&lt;/postalCode&gt;&#x0D;
&#x0D;
							   &lt;countryCode&gt;USA&lt;/countryCode&gt;&#x0D;
&#x0D;
						&lt;/address&gt;&#x0D;
&#x0D;
						   &lt;nciInstituteCode&gt;NCI&lt;/nciInstituteCode&gt;&#x0D;
&#x0D;
					&lt;/healthcareSite&gt;&#x0D;
&#x0D;
				&lt;/studySite&gt;&#x0D;
&#x0D;
				   &lt;studyRef&gt;&#x0D;
					   &lt;identifier xsi:type=&quot;OrganizationAssignedIdentifierType&quot;&gt;&#x0D;
						   &lt;type&gt;Coordinating Center Identifier&lt;/type&gt;&#x0D;
&#x0D;
						   &lt;value&gt;SMOKE_TEST&lt;/value&gt;&#x0D;
&#x0D;
						   &lt;primaryIndicator&gt;true&lt;/primaryIndicator&gt;&#x0D;
&#x0D;
						   &lt;healthcareSite&gt;&#x0D;
							   &lt;name&gt;National Cancer Institute&lt;/name&gt;&#x0D;
&#x0D;
							   &lt;address&gt;&#x0D;
								   &lt;streetAddress&gt;6116 Executive Boulevard&lt;/streetAddress&gt;&#x0D;
&#x0D;
								   &lt;city&gt;Bethesda&lt;/city&gt;&#x0D;
&#x0D;
								   &lt;stateCode&gt;MD&lt;/stateCode&gt;&#x0D;
&#x0D;
								   &lt;postalCode&gt;20892&lt;/postalCode&gt;&#x0D;
&#x0D;
								   &lt;countryCode&gt;USA&lt;/countryCode&gt;&#x0D;
&#x0D;
							&lt;/address&gt;&#x0D;
&#x0D;
							   &lt;nciInstituteCode&gt;NCI&lt;/nciInstituteCode&gt;&#x0D;
&#x0D;
						&lt;/healthcareSite&gt;&#x0D;
&#x0D;
					&lt;/identifier&gt;&#x0D;
&#x0D;
				&lt;/studyRef&gt;&#x0D;
&#x0D;
				   &lt;participant gridId=&quot;87615e61-a900-47bc-8d62-3db4c9fa3659&quot;&gt;&#x0D;
					   &lt;firstName&gt;Saurabh&lt;/firstName&gt;&#x0D;
&#x0D;
					   &lt;lastName&gt;Ganguly&lt;/lastName&gt;&#x0D;
&#x0D;
					   &lt;address/&gt;&#x0D;
&#x0D;
					   &lt;administrativeGenderCode&gt;Male&lt;/administrativeGenderCode&gt;&#x0D;
&#x0D;
					   &lt;birthDate&gt;2001-01-01&lt;/birthDate&gt;&#x0D;
&#x0D;
					   &lt;ethnicGroupCode&gt;Non Hispanic or Latino&lt;/ethnicGroupCode&gt;&#x0D;
&#x0D;
					   &lt;raceCode&gt;Asian : White&lt;/raceCode&gt;&#x0D;
&#x0D;
					   &lt;identifier xsi:type=&quot;OrganizationAssignedIdentifierType&quot;&gt;&#x0D;
						   &lt;type&gt;MRN&lt;/type&gt;&#x0D;
&#x0D;
						   &lt;value&gt;6-5-43-43-2&lt;/value&gt;&#x0D;
&#x0D;
						   &lt;primaryIndicator&gt;true&lt;/primaryIndicator&gt;&#x0D;
&#x0D;
						   &lt;healthcareSite&gt;&#x0D;
							   &lt;name&gt;M D Anderson Cancer Center&lt;/name&gt;&#x0D;
&#x0D;
							   &lt;address&gt;&#x0D;
								   &lt;city&gt;Houston&lt;/city&gt;&#x0D;
&#x0D;
								   &lt;stateCode&gt;TX&lt;/stateCode&gt;&#x0D;
&#x0D;
								   &lt;countryCode&gt;USA&lt;/countryCode&gt;&#x0D;
&#x0D;
							&lt;/address&gt;&#x0D;
&#x0D;
							   &lt;nciInstituteCode&gt;MDA&lt;/nciInstituteCode&gt;&#x0D;
&#x0D;
						&lt;/healthcareSite&gt;&#x0D;
&#x0D;
					&lt;/identifier&gt;&#x0D;
&#x0D;
				&lt;/participant&gt;&#x0D;
&#x0D;
				   &lt;startDate&gt;2010-04-16&lt;/startDate&gt;&#x0D;
&#x0D;
				   &lt;informedConsentFormSignedDate&gt;2010-04-16&lt;/informedConsentFormSignedDate&gt;&#x0D;
&#x0D;
				   &lt;informedConsentVersion&gt;234asdf&lt;/informedConsentVersion&gt;&#x0D;
&#x0D;
				   &lt;identifier xsi:type=&quot;SystemAssignedIdentifierType&quot;&gt;&#x0D;
					   &lt;type&gt;Study Subject Identifier&lt;/type&gt;&#x0D;
&#x0D;
					   &lt;value&gt;c3882907-ac9e-4a00-8ab5-c2b219c005c8&lt;/value&gt;&#x0D;
&#x0D;
					   &lt;primaryIndicator&gt;false&lt;/primaryIndicator&gt;&#x0D;
&#x0D;
					   &lt;systemName&gt;C3PR&lt;/systemName&gt;&#x0D;
&#x0D;
				&lt;/identifier&gt;&#x0D;
&#x0D;
				   &lt;identifier xsi:type=&quot;OrganizationAssignedIdentifierType&quot;&gt;&#x0D;
					   &lt;type&gt;COORDINATING_CENTER_ASSIGNED_STUDY_SUBJECT_IDENTIFIER&lt;/type&gt;&#x0D;
&#x0D;
					   &lt;value&gt;8&lt;/value&gt;&#x0D;
&#x0D;
					   &lt;primaryIndicator&gt;false&lt;/primaryIndicator&gt;&#x0D;
&#x0D;
					   &lt;healthcareSite&gt;&#x0D;
						   &lt;name&gt;National Cancer Institute&lt;/name&gt;&#x0D;
&#x0D;
						   &lt;address&gt;&#x0D;
							   &lt;streetAddress&gt;6116 Executive Boulevard&lt;/streetAddress&gt;&#x0D;
&#x0D;
							   &lt;city&gt;Bethesda&lt;/city&gt;&#x0D;
&#x0D;
							   &lt;stateCode&gt;MD&lt;/stateCode&gt;&#x0D;
&#x0D;
							   &lt;postalCode&gt;20892&lt;/postalCode&gt;&#x0D;
&#x0D;
							   &lt;countryCode&gt;USA&lt;/countryCode&gt;&#x0D;
&#x0D;
						&lt;/address&gt;&#x0D;
&#x0D;
						   &lt;nciInstituteCode&gt;NCI&lt;/nciInstituteCode&gt;&#x0D;
&#x0D;
					&lt;/healthcareSite&gt;&#x0D;
&#x0D;
				&lt;/identifier&gt;&#x0D;
&#x0D;
				   &lt;scheduledEpoch gridId=&quot;866bb881-e2cb-444d-ad21-54d95e5f5d7e&quot; xsi:type=&quot;ScheduledTreatmentEpochType&quot;&gt;&#x0D;
					   &lt;startDate&gt;2010-04-16&lt;/startDate&gt;&#x0D;
&#x0D;
					   &lt;epoch gridId=&quot;866bb881-e2cb-444d-ad21-54d95e5f5d7e&quot; xsi:type=&quot;TreatmentEpochType&quot;&gt;&#x0D;
						   &lt;name&gt;Ep1&lt;/name&gt;&#x0D;
&#x0D;
						   &lt;descriptionText/&gt;&#x0D;
&#x0D;
						   &lt;arm gridId=&quot;0914c482-27c0-4ca5-b08a-48e98737d0f3&quot;&gt;&#x0D;
							   &lt;name&gt;Arm A&lt;/name&gt;&#x0D;
&#x0D;
							   &lt;descriptionText/&gt;&#x0D;
&#x0D;
							   &lt;targetAccrualNumber&gt;50&lt;/targetAccrualNumber&gt;&#x0D;
&#x0D;
						&lt;/arm&gt;&#x0D;
&#x0D;
					&lt;/epoch&gt;&#x0D;
&#x0D;
					   &lt;scheduledArm&gt;&#x0D;
						   &lt;arm gridId=&quot;0914c482-27c0-4ca5-b08a-48e98737d0f3&quot;&gt;&#x0D;
							   &lt;name&gt;Arm A&lt;/name&gt;&#x0D;
&#x0D;
							   &lt;descriptionText/&gt;&#x0D;
&#x0D;
							   &lt;targetAccrualNumber&gt;50&lt;/targetAccrualNumber&gt;&#x0D;
&#x0D;
						&lt;/arm&gt;&#x0D;
&#x0D;
					&lt;/scheduledArm&gt;&#x0D;
&#x0D;
					   &lt;eligibilityIndicator&gt;true&lt;/eligibilityIndicator&gt;&#x0D;
&#x0D;
				&lt;/scheduledEpoch&gt;&#x0D;
&#x0D;
			&lt;/registration&gt;&#x0D;
  &lt;/ns1:businessMessagePayload&gt;&#x0D;
 &lt;/ns1:request&gt;&#x0D;
&lt;/ns1:caXchangeRequestMessage&gt;&#x0D;
</inboundTemplate>
      <outboundTemplate></outboundTemplate>
      <inboundProtocol>XML</inboundProtocol>
      <outboundProtocol>XML</outboundProtocol>
      <inboundProperties>
        <property name="stripNamespaces">false</property>
      </inboundProperties>
      <outboundProperties>
        <property name="stripNamespaces">false</property>
      </outboundProperties>
    </transformer>
    <filter>
      <rules/>
    </filter>
    <transportName>JMS Reader</transportName>
    <mode>SOURCE</mode>
    <enabled>true</enabled>
  </sourceConnector>
  <destinationConnectors>
    <com.webreach.mirth.model.Connector>
      <name>Persist Message In Database</name>
      <properties>
        <property name="username"></property>
        <property name="DataType">Database Writer</property>
        <property name="useScript">1</property>
        <property name="URL">jdbc:postgresql://host:port/dbname</property>
        <property name="query"></property>
        <property name="script">insertIncomingMessageInDB($(&apos;ns1metadata_ns1caxchangeidentifier&apos;), $(&apos;ns1request_ns1businessmessagepayload&apos;), 
	Packages.gov.nih.nci.ihub.util.HubConstants.MESSAGE_STATUS_IN_PROCESS, $(&apos;ns1request_ns1businessmessagepayload_ns1xmlschemadefinition&apos;), $(&apos;ns1metadata&apos;));</property>
        <property name="password"></property>
        <property name="driver">org.postgresql.Driver</property>
        <property name="host">query</property>
      </properties>
      <transformer>
        <steps/>
        <inboundTemplate></inboundTemplate>
        <outboundTemplate></outboundTemplate>
        <inboundProtocol>XML</inboundProtocol>
        <outboundProtocol>XML</outboundProtocol>
        <inboundProperties>
          <property name="stripNamespaces">false</property>
        </inboundProperties>
        <outboundProperties/>
      </transformer>
      <filter>
        <rules/>
      </filter>
      <transportName>Database Writer</transportName>
      <mode>DESTINATION</mode>
      <enabled>true</enabled>
    </com.webreach.mirth.model.Connector>
    <com.webreach.mirth.model.Connector>
      <name>Validate Payload</name>
      <properties>
        <property name="script">try{
	logger.debug(&quot;Processing Validate Payload Destination&quot;);
	validatePayload(globalMap.get(&quot;Schema_Factory&quot;), globalMap.get($(&apos;ns1metadata_ns1servicetype&apos;)+&quot;.namespace&quot;), $(&apos;ns1metadata_ns1servicetype&apos;), 
		$(&apos;ns1request_ns1businessmessagepayload&apos;));
} catch (error) {
	logger.error(&quot;EXCEPTION OCCURED IN MIRTH DURING PAYLOAD VALIDATION: &quot;+error.message);
	recordMessageProcessingError(error, Packages.gov.nih.nci.ihub.util.HubConstants.TARGET_DETAIL_VALIDATION, $(&apos;ns1metadata_ns1caxchangeidentifier&apos;),
			$(&apos;ns1metadata_ns1externalidentifier&apos;), $(&apos;ns1request_ns1businessmessagepayload_ns1xmlschemadefinition&apos;));
}
</property>
        <property name="DataType">JavaScript Writer</property>
        <property name="host">sink</property>
      </properties>
      <transformer>
        <steps/>
        <inboundTemplate></inboundTemplate>
        <inboundProtocol>XML</inboundProtocol>
        <outboundProtocol>XML</outboundProtocol>
        <inboundProperties>
          <property name="stripNamespaces">false</property>
        </inboundProperties>
      </transformer>
      <filter>
        <rules>
          <com.webreach.mirth.model.Rule>
            <sequenceNumber>0</sequenceNumber>
            <name>Accept message if &quot;$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)&quot; equals false</name>
            <data class="map">
              <entry>
                <string>OriginalField</string>
                <string></string>
              </entry>
              <entry>
                <string>Values</string>
                <list>
                  <string>false</string>
                </list>
              </entry>
              <entry>
                <string>Equals</string>
                <string>1</string>
              </entry>
              <entry>
                <string>Field</string>
                <string>$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)</string>
              </entry>
              <entry>
                <string>Name</string>
                <string></string>
              </entry>
              <entry>
                <string>Accept</string>
                <string>1</string>
              </entry>
            </data>
            <type>Rule Builder</type>
            <script>if($(&apos;IS_IHUB_PROCESSING_ERROR&apos;) == false)
{
return true;
}
return false;</script>
            <operator>NONE</operator>
          </com.webreach.mirth.model.Rule>
        </rules>
      </filter>
      <transportName>JavaScript Writer</transportName>
      <mode>DESTINATION</mode>
      <enabled>true</enabled>
    </com.webreach.mirth.model.Connector>
    <com.webreach.mirth.model.Connector>
      <name>Retrieve Security Subject</name>
      <properties>
        <property name="script">try{	
	var subject = invokeDelegationService($(&apos;ns1metadata_ns1credentials_ns1delegatedcredentialreference&apos;), globalMap.get(&quot;delegation.certificate.file.path&quot;),
	 				globalMap.get(&quot;delegation.key.file.path&quot;), Packages.gov.nih.nci.ihub.util.HubConstants.TARGET_DETAIL_DELEGATION, 
					$(&apos;ns1metadata_ns1caxchangeidentifier&apos;));
	globalMap.put(&quot;subject&quot;+$(&apos;ns1metadata_ns1caxchangeidentifier&apos;), subject);
} catch (error) {
	logger.error(&quot;EXCEPTION OCCURED IN MIRTH WHILE OBTAINING SUBJECT: &quot;+error.message);
	recordMessageProcessingError(error, Packages.gov.nih.nci.ihub.util.HubConstants.TARGET_DETAIL_DELEGATION, $(&apos;ns1metadata_ns1caxchangeidentifier&apos;),
			$(&apos;ns1metadata_ns1externalidentifier&apos;), $(&apos;ns1request_ns1businessmessagepayload_ns1xmlschemadefinition&apos;));
}</property>
        <property name="DataType">JavaScript Writer</property>
        <property name="host">sink</property>
      </properties>
      <transformer>
        <steps/>
        <inboundTemplate></inboundTemplate>
        <inboundProtocol>XML</inboundProtocol>
        <outboundProtocol>XML</outboundProtocol>
        <inboundProperties>
          <property name="stripNamespaces">false</property>
        </inboundProperties>
      </transformer>
      <filter>
        <rules>
          <com.webreach.mirth.model.Rule>
            <sequenceNumber>0</sequenceNumber>
            <name>Accept message if &quot;$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)&quot; equals false</name>
            <data class="map">
              <entry>
                <string>OriginalField</string>
                <string></string>
              </entry>
              <entry>
                <string>Values</string>
                <list>
                  <string>false</string>
                </list>
              </entry>
              <entry>
                <string>Equals</string>
                <string>1</string>
              </entry>
              <entry>
                <string>Field</string>
                <string>$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)</string>
              </entry>
              <entry>
                <string>Name</string>
                <string></string>
              </entry>
              <entry>
                <string>Accept</string>
                <string>1</string>
              </entry>
            </data>
            <type>Rule Builder</type>
            <script>if($(&apos;IS_IHUB_PROCESSING_ERROR&apos;) == false)
{
return true;
}
return false;</script>
            <operator>NONE</operator>
          </com.webreach.mirth.model.Rule>
        </rules>
      </filter>
      <transportName>JavaScript Writer</transportName>
      <mode>DESTINATION</mode>
      <enabled>true</enabled>
    </com.webreach.mirth.model.Connector>
    <com.webreach.mirth.model.Connector>
      <name>Suite Broadcaster</name>
      <properties>
        <property name="DataType">Channel Writer</property>
        <property name="synchronised">1</property>
        <property name="template">${message.encodedData}</property>
        <property name="host">afe931ad-7ed6-4894-b755-aaf7d5c2a492</property>
      </properties>
      <transformer>
        <steps/>
        <inboundTemplate></inboundTemplate>
        <inboundProtocol>XML</inboundProtocol>
        <outboundProtocol>XML</outboundProtocol>
        <inboundProperties>
          <property name="stripNamespaces">false</property>
        </inboundProperties>
      </transformer>
      <filter>
        <rules>
          <com.webreach.mirth.model.Rule>
            <sequenceNumber>0</sequenceNumber>
            <name>Accept message if &quot;$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)&quot; equals false</name>
            <data class="map">
              <entry>
                <string>OriginalField</string>
                <string></string>
              </entry>
              <entry>
                <string>Values</string>
                <list>
                  <string>false</string>
                </list>
              </entry>
              <entry>
                <string>Equals</string>
                <string>1</string>
              </entry>
              <entry>
                <string>Field</string>
                <string>$(&apos;IS_IHUB_PROCESSING_ERROR&apos;)</string>
              </entry>
              <entry>
                <string>Name</string>
                <string></string>
              </entry>
              <entry>
                <string>Accept</string>
                <string>1</string>
              </entry>
            </data>
            <type>Rule Builder</type>
            <script>if($(&apos;IS_IHUB_PROCESSING_ERROR&apos;) == false)
{
return true;
}
return false;</script>
            <operator>NONE</operator>
          </com.webreach.mirth.model.Rule>
        </rules>
      </filter>
      <transportName>Channel Writer</transportName>
      <mode>DESTINATION</mode>
      <enabled>true</enabled>
    </com.webreach.mirth.model.Connector>
    <com.webreach.mirth.model.Connector>
      <name>Suite A-Sync JMSWriter</name>
      <properties>
        <property name="DataType">Channel Writer</property>
        <property name="synchronised">1</property>
        <property name="template">${message.encodedData}</property>
        <property name="host">b5146b95-5701-42eb-84b9-cdb6b6d88749</property>
      </properties>
      <transformer>
        <steps/>
        <inboundProtocol>XML</inboundProtocol>
        <outboundProtocol>XML</outboundProtocol>
        <inboundProperties>
          <property name="stripNamespaces">false</property>
        </inboundProperties>
      </transformer>
      <filter>
        <rules/>
      </filter>
      <transportName>Channel Writer</transportName>
      <mode>DESTINATION</mode>
      <enabled>true</enabled>
    </com.webreach.mirth.model.Connector>
  </destinationConnectors>
  <properties>
    <property name="initialState">started</property>
    <property name="synchronous">true</property>
    <property name="store_messages">true</property>
    <property name="encryptData">false</property>
    <property name="transactional">false</property>
    <property name="max_message_age">-1</property>
    <property name="dont_store_filtered">false</property>
    <property name="error_messages_only">false</property>
  </properties>
  <preprocessingScript>// Modify the message variable below to pre process data
return message;</preprocessingScript>
  <postprocessingScript>// This script executes once after a message has been processed
return;</postprocessingScript>
  <deployScript>var fileSystemSchemaFactory = new Packages.gov.nih.nci.ihub.writer.ncies.infrastructure.validation.FileSystemSchemaFactory();
fileSystemSchemaFactory.setSchemaDirectoryLocation(globalMap.get(&quot;gme.cache.directory&quot;));
//fileSystemSchemaFactory.setSchemaDirectoryLocation(&apos;C:/projects_svn/ihub-mirth/trunk/software/common/resources/payloadSchemas&apos;);
fileSystemSchemaFactory.init();

var gmeSchemaFactory = new Packages.gov.nih.nci.ihub.writer.ncies.infrastructure.validation.GMESchemaFactory();
gmeSchemaFactory.setCacheDirectoryLocation(globalMap.get(&quot;gme.cache.directory&quot;));
gmeSchemaFactory.setGMEGridServiceLocation(globalMap.get(&quot;gme.service.url&quot;));
gmeSchemaFactory.init();

globalMap.put(&quot;Schema_Factory&quot;, fileSystemSchemaFactory);
//globalMap.put(&quot;Schema_Factory&quot;, gmeSchemaFactory);

// This script executes once when the mule engine is started
// You only have access to the globalMap here to persist data

return;</deployScript>
  <shutdownScript>// This script executes once when the mule engine is stopped
// You only have access to the globalMap here to persist data
return;</shutdownScript>
</com.webreach.mirth.model.Channel>